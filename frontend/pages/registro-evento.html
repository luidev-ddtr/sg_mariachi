<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestión de eventos | Mariachis San Nicolás</title>
  <!-- Google Material Icons -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined">

<!-- Link del archivo CSS -->  
<link rel="stylesheet" href="../src/styles/styles_registro_eventos.css">
</head>

<body>
  <!-- Contenedor general -->
  <div class="container">

   

    <!-- Contenido principal -->
    <main class="main-content">
      <header class="header">
        <h1 id="tituloPrincipal">Gestión de eventos</h1>
      </header>

      <!-- Sección de tarjetas con resumen -->
      <section class="cards-section">
        <div class="card completados">
          <p>Eventos Completados</p>
          <h2 id="totalCompletados">250</h2>
          <span class="material-symbols-outlined icon-card">done_outline</span>
        </div>

        <div class="card pendientes">
          <p>Eventos Pendientes</p>
          <h2 id="totalPendientes">90</h2>
          <span class="material-symbols-outlined icon-card">schedule</span>
        </div>

        <div class="card totales">
          <p>Eventos Totales</p>
          <h2 id="totalEventos">340</h2>
          <span class="material-symbols-outlined icon-card">bar_chart_4_bars</span>
        </div>
      </section>

      <!-- Filtros -->
      <section class="filters">
        <input type="date" id="inputFecha" />
        <select id="selectEstado">
          <option value="todos">Estado: Todos</option>
          <option value="completado">Completado</option>
          <option value="pendiente">Pendiente</option>
          <option value="cancelado">Cancelado</option>
        </select>

        <button id="btnFiltrar" class="btn red">
        <span class="material-symbols-outlined">search</span> Filtrar
        </button>
        <button id="btnNuevaReserva" class="btn green">
        <span class="material-symbols-outlined">add</span> Nueva reserva
        </button>
      </section>

      <!-- Tabla de eventos -->
      <section class="table-section">
        <table id="tabla-eventos">
          <thead>
            <tr>
              <th>No. Eventos</th>
              <th>Cliente</th>
              <th>Teléfono</th>
              <th>Fecha</th>
              <th>Hr Inicio</th>
              <th>Hr Final</th>
              <th>Monto</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>

          </tbody>
        </table>
      </section>
    </main> 
  </div> 
  <div id="modalOverlay" class="modal-overlay">
    <div class="modal-container">
      <button id="modalClose" class="modal-close-btn">&times;</button>
      <iframe id="modalFrame" src="about:blank" frameborder="0"></iframe>
    </div>
  </div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
  // Elementos del DOM
    const btnNuevaReserva = document.getElementById("btnNuevaReserva");
    const modalOverlay = document.getElementById("modalOverlay");
    const modalFrame = document.getElementById("modalFrame");
    const modalClose = document.getElementById("modalClose");

  // URL del formulario que se cargará en el modal.
    const modalUrl = "/src/components/eventos/formulario_nvo_evento.html";

  // 1. Abrir el modal al hacer clic en "Nueva Reserva"
    btnNuevaReserva.addEventListener("click", () => {
      console.log("Abriendo modal...");
     // Cargamos la URL en el iframe
      modalFrame.src = modalUrl;
      // Mostramos el modal añadiendo la clase 'visible'
      modalOverlay.classList.add("visible");
   });

    // 2. Función para cerrar y limpiar el modal
    function closeModal() {
      modalOverlay.classList.remove("visible");
      // Limpiamos el src para detener cualquier proceso en el iframe
      modalFrame.src = "about:blank";
    }

    // 3. Cerrar el modal con el botón 'X'.
    modalClose.addEventListener("click", () => {
      closeModal();
    });

    // 4. (Opcional) Cerrar el modal al hacer clic en el fondo
    modalOverlay.addEventListener("click", (event) => {
      // Si el clic fue directamente en el fondo (overlay) y no en el contenido
      if (event.target === modalOverlay) {
       closeModal();
      }
    });

  });
</script>
<script src="../src/components/eventos/mostrar_reservaciones.js" type="module"></script>
<div id="confirmArchiveModal" class="modal-overlay" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-header">
      <h4>Confirmar Acción</h4>
      <span class="modal-close" data-dismiss="modal">&times;</span>
    </div>
    <div class="modal-body">
      <p>¿Estás seguro de que deseas archivar esta reservación?</p>
    </div>
    <div class="modal-footer">
      <button id="btn-cancel-archive" class="btn btn-secondary">Cancelar</button>
      <button id="btn-confirm-archive" class="btn btn-danger">Sí, Archivar</button>
    </div>
  </div>
</div>
</body>
</html>